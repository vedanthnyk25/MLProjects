# -*- coding: utf-8 -*-
"""Wine Quality Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1gxke5dpqVIE61EeaJEEUdGGmSKH-JLdT
"""

import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score

wine_dataset=pd.read_csv('/content/winequality-red.csv')

wine_dataset.head()

wine_dataset.isnull().sum()

wine_dataset.describe()

sns.catplot(x='quality',data=wine_dataset, kind='count')

wine_dataset=pd.read_csv('/content/winequality-red.csv')
plot=plt.figure
fig_size=(5,5)
sns.barplot(x= 'quality', y= 'volatile acidity',data=wine_dataset)

plot=plt.figure
fig_size=(5,5)
sns.barplot(x= 'quality', y= 'citric acid',data=wine_dataset)

correlation=wine_dataset.corr()

plt.figure(figsize=(7,7))
sns.heatmap(correlation, cbar=True,square=True,fmt='.1f',annot=True,annot_kws={'size':8},cmap='Greens')

x=wine_dataset.drop('quality', axis=1)

y=wine_dataset['quality'].apply(lambda y_value:1 if y_value>=7 else 0)

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=2)

model=RandomForestClassifier()

model.fit(x_train, y_train)

train_pred=model.predict(x_train)

train_acc=accuracy_score(y_train,train_pred)
print(train_acc*100)

test_pred=model.predict(x_test)
test_acc=accuracy_score(y_test, test_pred)
print(test_acc*100)

input_data=(8.319637,	0.527821,	0.270976,	2.538806,	0.087467,	15.874922,	46.467792,	0.996747,	3.311113,	0.658149	,10.422983)
input_data_np=np.asarray(input_data)
reshaped_data=input_data_np.reshape(1,-1)
prediction=model.predict(reshaped_data)
print(prediction)

